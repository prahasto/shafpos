var Utility=Utility||{};Utility={init:function(){App.transitionEnd=Utility.whichTransitionEnd(),App.firstScript=document.getElementsByTagName("script")[0];var a=document.querySelectorAll(".js-top");a&&[].forEach.call(a,function(a){a.addEventListener("click",function(a){a.preventDefault(),Utility.scrollTop()})});var b=document.querySelectorAll(".js-anchor");b&&[].forEach.call(b,function(a){a.addEventListener("click",function(a){a.preventDefault(),Utility.anchorScrollTo(this)})})},addClass:function(a,b){function c(a,b){a.classList?a.classList.add(b):a.classList+=" "+b}if(b.indexOf(" ")==-1)c(a,b);else{var d=b.split(" ");d.forEach(function(b){c(a,b)})}},hasClass:function(a,b){function c(a,b){return a.classList?a.classList.contains(b):new RegExp("(^| )"+b+"( |$)","gi").test(a.className)}if(b.indexOf(" ")!=-1){var d=!0,e=b.split(" ");return e.forEach(function(b){c(a,b)||(d=!1)}),d}c(a,b)},removeClass:function(a,b){function c(a,b){a.classList?a.classList.remove(b):a.className=a.className.replace(new RegExp("(^|\\b)"+b.split(" ").join("|")+"(\\b|$)","gi")," ")}if(b.indexOf(" ")==-1)c(a,b);else{var d=b.split(" ");d.forEach(function(b){c(a,b)})}},toggleClass:function(a,b){if(a.classList)a.classList.toggle(b);else{var c=a.className.split(" "),d=c.indexOf(b);d>=0?c.splice(d,1):c.push(b),a.className=c.join(" ")}},isEmail:function(a){return/^([^\x00-\x20\x22\x28\x29\x2c\x2e\x3a-\x3c\x3e\x40\x5b-\x5d\x7f-\xff]+|\x22([^\x0d\x22\x5c\x80-\xff]|\x5c[\x00-\x7f])*\x22)(\x2e([^\x00-\x20\x22\x28\x29\x2c\x2e\x3a-\x3c\x3e\x40\x5b-\x5d\x7f-\xff]+|\x22([^\x0d\x22\x5c\x80-\xff]|\x5c[\x00-\x7f])*\x22))*\x40([^\x00-\x20\x22\x28\x29\x2c\x2e\x3a-\x3c\x3e\x40\x5b-\x5d\x7f-\xff]+|\x5b([^\x0d\x5b-\x5d\x80-\xff]|\x5c[\x00-\x7f])*\x5d)(\x2e([^\x00-\x20\x22\x28\x29\x2c\x2e\x3a-\x3c\x3e\x40\x5b-\x5d\x7f-\xff]+|\x5b([^\x0d\x5b-\x5d\x80-\xff]|\x5c[\x00-\x7f])*\x5d))*$/.test(a)},scrollTo:function(a,b,c,d){function e(a,b){return a<b?a:b}function f(j){var k=Date.now(),l=e(1,(k-g)/b),m=c(l);h.scrollTop=m*(a-i)+i,l<1?requestAnimationFrame(f):d&&d()}var g=Date.now(),h=document.documentElement.scrollTop?document.documentElement:document.body,i=h.scrollTop;return i===a?void d():void requestAnimationFrame(f)},anchorScrollTo:function(a){var b=a.getAttribute("href"),c=document.querySelector(b),d=c.getBoundingClientRect(),e=d.top+document.body.scrollTop;Utility.scrollTo(e,300,function(a){return a<.5?4*a*a*a:(a-1)*(2*a-2)*(2*a-2)+1})},scrollTop:function(a){"undefined"==typeof a&&(a=300),Utility.scrollTo(0,a,function(a){return a<.5?4*a*a*a:(a-1)*(2*a-2)*(2*a-2)+1})},getScript:function(a){var b=document.createElement("script");b.src=a,App.firstScript.parentNode.insertBefore(b,App.firstScript)},whichTransitionEnd:function(){var a,b=document.createElement("fakeelement"),c={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(a in c)if(void 0!==b.style[a])return c[a]},windowOpen:function(a,b,c){var d=screen.width/2-b/2,e=screen.height/2-c/2;window.open(a,"","menubar=no,toolbar=no,resizable=yes,scrollbars=yes,width="+b+",height="+c+",top="+e+",left="+d)},browserIsChromeiOS:function(){return!!navigator.userAgent.match("CriOS")}};var Social=Social||{};Social={facebookAppId:"146160702084886",disqusShortName:"jonsuh",load:function(){var a=document.querySelector(".post-comments");a&&(Utility.addClass(a,"is-loaded"),Social.commentsInit())},init:function(){var a=document.querySelector(".js-social-twitter-share");a&&(Social.facebookInit(),Social.googleInit(),Social.twitterInit())},commentsLoad:function(a){a.preventDefault(),Utility.getScript("//"+Social.disqusShortName+".disqus.com/embed.js"),Utility.addClass(this,"is-hidden")},commentsInit:function(){var a=document.querySelectorAll(".js-comments-load");[].forEach.call(a,function(a){a.addEventListener("click",Social.commentsLoad)})},facebookInit:function(){var a=document.querySelectorAll(".js-social-facebook-share");[].forEach.call(a,function(a){a.addEventListener("click",Social.facebookShare)})},facebookShare:function(a){a.preventDefault(),Utility.windowOpen(this.getAttribute("href"),600,350)},googleInit:function(){var a=document.querySelectorAll(".js-social-google-share");[].forEach.call(a,function(a){a.addEventListener("click",Social.googleShare)})},googleShare:function(a){a.preventDefault(),Utility.windowOpen(this.getAttribute("href"),600,360)},twitterInit:function(){var a=document.querySelectorAll(".js-social-twitter-share");[].forEach.call(a,function(a){a.addEventListener("click",Social.twitterShare)})},twitterShare:function(a){a.preventDefault(),Utility.windowOpen(this.getAttribute("href"),600,300)}};var Work=Work||{};Work={init:function(){Work.psalmsCD()},psalmsCD:function(){var a=document.querySelector(".js-psalms-cd-product-animate");if(a){var b=document.querySelector(".psalms-cd-product-disc");a.addEventListener("click",function(){Utility.toggleClass(b,"is-animated")})}var c=document.querySelector(".js-psalms-cd-brand-animate");if(c){var d=document.querySelector(".psalms-cd-brand-logo-overlay-image"),e=document.querySelector(".psalms-cd-brand-logo-container");c.addEventListener("mousemove",function(){var a=this.offsetWidth,b=this.offsetLeft,c=event.pageX;document.querySelector(".psalms-cd-brand-logo-overlay").style.left=c-b+"px",d.style.width=a+"px"}),window.addEventListener("resize",function(){d.style.width=e.offsetWidth+"px"})}}};var App=App||{};App={transitionEnd:null,init:function(){Utility.init(),Social.load(),App.error404Init(),App.newsletterInit(),Work.init(),App.cookieInit(),App.codePenInit(),App.flickityInit(),Social.init(),App.outboundInit();var a=document.querySelector(".about-sidebar-break");a&&setTimeout(function(){var b=document.querySelector("#carbonads");b&&Utility.addClass(a,"has-carbonads")},1e3)},codePenInit:function(){var a=document.querySelector(".codepen");a&&loadJS("//assets.codepen.io/assets/embed/ei.js")},cookieInit:function(){null===cookie("mainJS")&&cookie("mainJS","true",1)},error404Init:function(){var a=document.querySelector(".js-error-404");if(a){var b=document.getElementsByTagName("audio")[0];a.addEventListener("click",function(a){a.preventDefault(),b.volume=.5,b.play()})}},flickityInit:function(){var a=document.querySelector(".js-flickity");a&&loadJS("/assets/js/flickity.js")},newsletterInit:function(){var a=document.querySelector(".js-form-newsletter");document.querySelectorAll(".js-form-newsletter input");a&&a.addEventListener("submit",function(b){b.preventDefault(),App.newsletterValidate(a)})},newsletterValidate:function(a){var b=a.querySelector("input[type=email]"),c="Invalid email address";if(Utility.isEmail(b.value)){Utility.removeClass(b,"has-error");var d=b.nextSibling;d&&d.parentNode.removeChild(d),a.submit(),setTimeout(function(){b.value=""},500)}else{var e=b.nextSibling;if("has-error"!=e.className){var d=document.createElement("div");Utility.addClass(b,"has-error"),d.className="has-error",d.innerHTML=c,b.parentNode.insertBefore(d,b.nextSibling)}b.focus()}},outboundInit:function(){var a=document.querySelectorAll(".js-outbound");[].forEach.call(a,function(a){a.addEventListener("click",App.outboundClick)})},outboundClick:function(a){a.preventDefault();var b=this.getAttribute("href");ga&&ga("send","event","outbound","click",b),window.open(b,"_blank")}},App.init();